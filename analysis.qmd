---
title: "Two Parameters"
author: "Lela"
format: html
execute:
  echo: FALSE
---

```{r}
#| message: FALSE

library(tidyverse)
library(primer.data)
library(gtsummary)
```

```{r}
nhanes |>
filter(sex == "Male", age >= 18) |>
select(height) |>
drop_na() |>
ggplot(aes(x = height)) +
geom_histogram(bins = 50) +
labs(title = "Male Adult Height in the US in 2010",
x = "Height (cm)",
y = "Count")
```

```{r}
#| message: FALSE
library(tidybayes)
library(brms)
```

```{r}
#| cache: TRUE
ch5 <- nhanes |>
  filter(sex == "Male", age >= 18) |>
  select(height) |>
  drop_na()

fit_male_height <- brm(formula = height ~ 1, data = ch5,
    family = gaussian(),
    silent = 2,
    refresh = 0,
    seed = 12)
```

```{r}
#| label: plot
ndata <- tibble(.rows = 1)
fit_male_height |>
add_predicted_draws(newdata = ndata) |>
ggplot(aes(x = .prediction)) +
geom_histogram(aes(y = after_stat(count / sum(count))),
               bins = 100) +
labs(title = "Posterior of Male Heights",
     subtitle = "Uncertainty for a single individual is greater than for the expected value",
     x = "Height in centimeters",
     y = "Probability") + 
scale_x_continuous(labels = scales::number_format()) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))
```

We aim to create a model of height for male adults to determine the average height of an adult male in America using the nhanes data set from the National Health and Nutrition Examination Survey, conducted from 2009 to 2011 by the Centers for Disease Control and Prevention. This data set includes variables representing physical attributes, like weight and height. Because participation in this survey was voluntary, it is possible that shorter men were less likely to answer height-focused questions. We modeled height, in centimeters, using an intercept-only regression model. The average height of adult men in America is 176 centimeters, with a standard deviation of 7.48 centimeters. 

```{r}
tbl_regression(fit_male_height, intercept = TRUE)
```

```{r}
fit_male_height |>
add_predicted_draws(newdata = ndata) |>
mutate(tall = if_else(.prediction > 180, TRUE, FALSE)) |>
summarize(odds = mean(tall))
```

